(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-3f65","chunk-b1e5"],{"+zbL":function(e,t,o){"use strict";var a=o("02iu"),s={name:"SelectTree",components:{},props:{assiosRoom:{type:Boolean,default:function(){return!1}},expandedKeys:{type:Object,default:function(){return{}}},nodeKey:{type:String,default:function(){return""}},clearDepName:{type:Boolean,default:function(){return!1}},value:{type:String,default:""},defaultKepId:{type:Object,default:function(){return{}}}},data:function(){return{parentOrg:{},treeShow:!1,depName:"",treeData:[],defaultProps:{children:"children",label:"depName",id:"depId"},currentTreeData:""}},watch:{depName:function(e){this.treeShow&&""!==this.depName&&this.$refs.selectTreeRef.filter(e)},clearDepName:function(e){this.clearDepName&&(this.depName="")},value:{immediate:!0,handler:function(e){}}},created:function(){this.getTree()},mounted:function(){var e=this;""!==this.expandedKeys.depName&&(this.depName=this.expandedKeys.depName);var t=document.getElementById("selectTree");document.addEventListener("click",function(o){t.contains(o.target)?e.$set(e,"treeShow",!0):e.$set(e,"treeShow",!1)})},methods:{filterNode:function(e,t){return!e||-1!==t.depName.indexOf(e)},getTree:function(){var e=this;a.a.queryDepartmentApi().then(function(t){t.data&&(e.assiosRoom?(e.treeData=t.data.children,e.treeData.unshift({depName:"未分配",depId:t.data.depId})):e.treeData=[{depName:t.data.depName,depId:t.data.depId,children:t.data.children}]),e.parentOrg={depId:t.data.depId,depName:t.data.depName},e.$emit("getParentDep",e.parentOrg),e.defaultKepId.depName&&(e.depName=e.defaultKepId.depName)}).catch(function(e){})},handleNodeClick:function(e){this.$set(this,"depName",e.depName),this.$emit("treeNodeClick",e),this.treeShow=!1},clearClick:function(){this.$emit("clearClick")}}},i=(o("sNvy"),o("KHd+")),l=Object(i.a)(s,function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"selectTree",attrs:{id:"selectTree"}},[o("el-input",{ref:"treeInput",attrs:{placeholder:"请选择所属部门",size:"small",clearable:""},on:{clear:e.clearClick},model:{value:e.depName,callback:function(t){e.depName=t},expression:"depName"}}),e._v(" "),e.treeShow?o("div",{staticClass:"treeShow"},[o("el-tree",{ref:"selectTreeRef",staticClass:"filter-tree",attrs:{data:e.treeData,props:e.defaultProps,"filter-node-method":e.filterNode,"default-expanded-keys":[e.expandedKeys.depId],indent:8,"node-key":e.nodeKey},on:{"node-click":e.handleNodeClick}})],1):e._e()],1)},[],!1,null,null,null);l.options.__file="index.vue";t.a=l.exports},"2kZ5":function(e,t,o){"use strict";var a=o("KvgY");o.n(a).a},DqvW:function(e,t,o){"use strict";var a=o("Hd8I");o.n(a).a},EKBX:function(e,t,o){"use strict";o.r(t);var a={name:"RoomType",components:{uploadImg:o("KspW").default},props:{},data:function(){return{tabIndex:1,editableTabsValue:"1",estateRoomDetail:{hostingRooms:[{houseType:"夏威夷",houseArea:"20",roomName:"房型",houseDirection:"",chamberCount:"1",boardCount:"0",toiletCount:"0",name:"1",rent:"",deposit:"",payOfPayment:"",depositOfPayment:"",facilityItemsList:[],pictures:[]}]},estateRoomDetailRules:{roomDetail:{houseType:[{required:!0,message:"请输入房源类型",trigger:"blur"}]}},roomDirectionList:[{label:"朝南",value:1},{label:"朝北",value:2},{label:"朝东",value:3},{label:"朝西",value:4},{label:"东南",value:5},{label:"西南",value:6},{label:"东北",value:7},{label:"西北",value:8}],facilityGroup:[{label:"家电",facilitys:[{value:"2",label:"洗衣机"},{value:"3",label:"空调"},{value:"4",label:"冰箱"},{value:"5",label:"电视"}]},{label:"家具",facilitys:[{value:"1",label:"床"},{value:"7",label:"沙发"},{value:"8",label:"茶几"},{value:"10",label:"餐桌"}]},{label:"其他",facilitys:[{value:"6",label:"宽带"}]}],roomCheckbox:!1}},computed:{payList:function(){for(var e=[],t=0;t<13;t++)e.push({value:t,label:t+""});return e},depositList:function(){var e=this.payList.slice(0);return e.push({value:13,label:"自定义"}),e}},methods:{handleTabsEdit:function(e,t){if("add"===t){if(this.estateRoomDetail.hostingRooms.length>25)return;var o=this.estateRoomDetail.hostingRooms.length,a=++this.tabIndex+"";this.estateRoomDetail.hostingRooms.push({houseType:"",houseArea:"",roomName:"房型"+"ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("")[o],houseDirection:"",chamberCount:"1",boardCount:"0",toiletCount:"0",rent:"",deposit:"",name:a,payOfPayment:"",depositOfPayment:"",facilityItemsList:[],pictures:[]}),this.editableTabsValue=a}if("remove"===t){var s=this.estateRoomDetail.hostingRooms;console.log(this.estateRoomDetail.hostingRooms);var i=this.editableTabsValue;i===e&&s.forEach(function(t,o){if(t.name===e){var a=s[o+1]||s[o-1];a&&(i=a.name)}}),this.editableTabsValue=i,this.estateRoomDetail.hostingRooms=s.filter(function(t){return t.name!==e})}},handleDepositChange:function(e){if(13!==e.depositOfPayment){if(""===e.rent)return void(e.deposit="");if(e.deposit=e.rent*e.depositOfPayment,e.deposit=0===e.deposit?0:e.deposit.toFixed(2),e.roomName){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZ".indexOf(e.roomName.replace("房间",""));this.$refs.estateRoomDetail.validateField("hostingRooms."+t+".deposit")}}},selectRoomNum:function(){this.roomCheckbox=!0},handleRentChange:function(e){e.rent>0?(e.rent=Math.min(1e5,e.rent).toString(),e.rent.split(".")[1]?e.rent=Number(e.rent).toFixed(2):e.rent=e.rent+".00"):e.rent=0;if(""!==e.rent&&""!==e.depositOfPayment&&13!==e.depositOfPayment?(e.deposit=e.rent*e.depositOfPayment,e.deposit=0===e.deposit?0:e.deposit.toFixed(2)):e.deposit="",""!==e.depositOfPayment)if(e.roomName){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZ".indexOf(e.roomName.replace("房型",""));this.$refs.estateRoomDetail.validateField("hostingRooms."+t+".deposit")}else this.$refs.estateRoomDetail.validateField("deposit")}}},s=(o("dFus"),o("KHd+")),i=Object(s.a)(a,function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"addRoom"},[o("el-tabs",{attrs:{type:"border-card",editable:""},on:{edit:e.handleTabsEdit},model:{value:e.editableTabsValue,callback:function(t){e.editableTabsValue=t},expression:"editableTabsValue"}},e._l(e.estateRoomDetail.hostingRooms,function(t,a){return o("el-tab-pane",{key:a,attrs:{label:t.roomName,name:t.name}},[o("el-form",{ref:"roomTypeTabsForm",refInFor:!0,attrs:{rules:e.estateRoomDetailRules,"label-position":"right","label-width":"80px",size:"small"},model:{value:e.estateRoomDetail,callback:function(t){e.estateRoomDetail=t},expression:"estateRoomDetail"}},[o("el-row",{attrs:{gutter:5}},[o("el-col",{attrs:{span:10}},[o("el-form-item",{attrs:{prop:"hostingRooms."+a+".houseType",rules:e.estateRoomDetailRules.roomDetail.houseType,label:"房间类型"}},[o("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"如夏威夷",clearable:""},model:{value:e.estateRoomDetail.hostingRooms[a].houseType,callback:function(t){e.$set(e.estateRoomDetail.hostingRooms[a],"houseType",t)},expression:"estateRoomDetail.hostingRooms[index].houseType"}})],1)],1),e._v(" "),o("el-col",{attrs:{span:8}},[o("el-form-item",{staticClass:"room-item-count",attrs:{label:"房间面积"}},[o("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入房间面积",min:"0",clearable:"",type:"number"},model:{value:e.estateRoomDetail.hostingRooms[a].houseArea,callback:function(t){e.$set(e.estateRoomDetail.hostingRooms[a],"houseArea",t)},expression:"estateRoomDetail.hostingRooms[index].houseArea"}})],1)],1),e._v(" "),o("el-col",{staticClass:"inline-item-label",attrs:{span:3}},[e._v("m"),o("sup",[e._v("2")])])],1),e._v(" "),o("el-row",{attrs:{gutter:10}},[o("el-col",{attrs:{span:3}},[o("el-form-item",{attrs:{prop:"chamberCount",label:"户型"}})],1),e._v(" "),o("el-col",{attrs:{span:3}},[o("el-form-item",{staticClass:"room-item-count",staticStyle:{"margin-left":"px"},attrs:{label:"","label-width":"0",prop:"chamberCount"}},[o("el-select",{attrs:{placeholder:""},model:{value:e.estateRoomDetail.hostingRooms[a].chamberCount,callback:function(t){e.$set(e.estateRoomDetail.hostingRooms[a],"chamberCount",t)},expression:"estateRoomDetail.hostingRooms[index].chamberCount"}},e._l(10,function(e,t){return o("el-option",{key:e,attrs:{value:t}})}))],1)],1),e._v(" "),o("el-col",{staticClass:"inline-item-label",attrs:{span:1}},[e._v("\n            室\n          ")]),e._v(" "),o("el-col",{attrs:{span:3}},[o("el-form-item",{staticClass:"room-item-count",attrs:{label:"","label-width":"0",prop:"boardCount"}},[o("el-select",{attrs:{placeholder:""},model:{value:e.estateRoomDetail.hostingRooms[a].boardCount,callback:function(t){e.$set(e.estateRoomDetail.hostingRooms[a],"boardCount",t)},expression:"estateRoomDetail.hostingRooms[index].boardCount"}},e._l(10,function(e,t){return o("el-option",{key:e,attrs:{value:t}})}))],1)],1),e._v(" "),o("el-col",{staticClass:"inline-item-label",attrs:{span:1}},[e._v("\n            厅\n          ")]),e._v(" "),o("el-col",{attrs:{span:3}},[o("el-form-item",{staticClass:"room-item-count",attrs:{label:"","label-width":"0",prop:"toiletCount"}},[o("el-select",{attrs:{placeholder:""},model:{value:e.estateRoomDetail.hostingRooms[a].toiletCount,callback:function(t){e.$set(e.estateRoomDetail.hostingRooms[a],"toiletCount",t)},expression:"estateRoomDetail.hostingRooms[index].toiletCount"}},e._l(10,function(e,t){return o("el-option",{key:e,attrs:{value:t}})}))],1)],1),e._v(" "),o("el-col",{staticClass:"inline-item-label",attrs:{span:1}},[e._v("\n            卫\n          ")]),e._v(" "),o("el-col",{attrs:{span:4}},[o("el-form-item",{staticClass:"room-item-count",attrs:{"label-width":"0",prop:"houseDirection"}},[o("el-select",{staticClass:"room-detail-select",attrs:{placeholder:"朝向"},model:{value:e.estateRoomDetail.hostingRooms[a].houseDirection,callback:function(t){e.$set(e.estateRoomDetail.hostingRooms[a],"houseDirection",t)},expression:"estateRoomDetail.hostingRooms[index].houseDirection"}},e._l(e.roomDirectionList,function(e){return o("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1)],1)],1),e._v(" "),o("el-row",[o("el-col",{attrs:{span:15}},[o("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"房间设施"}},[o("el-select",{staticClass:"room-detail-select",staticStyle:{width:"82%"},attrs:{multiple:"",placeholder:"请选择"},model:{value:e.estateRoomDetail.hostingRooms[a].facilityItemsList,callback:function(t){e.$set(e.estateRoomDetail.hostingRooms[a],"facilityItemsList",t)},expression:"estateRoomDetail.hostingRooms[index].facilityItemsList"}},e._l(e.facilityGroup,function(t){return o("el-option-group",{key:t.label,attrs:{label:t.label}},e._l(t.facilitys,function(e){return o("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))}))],1)],1)],1),e._v(" "),o("el-row",{attrs:{gutter:10}},[o("el-col",{attrs:{span:3}},[o("el-form-item",{attrs:{"show-message":!1,label:"付款方式",prop:"chamberCount"}})],1),e._v(" "),o("el-col",{staticClass:"inline-item-label",staticStyle:{"margin-left":"-10px"},attrs:{span:1}},[e._v("\n            付\n          ")]),e._v(" "),o("el-col",{attrs:{span:4}},[o("el-form-item",{staticClass:"room-item-count",attrs:{label:"","label-width":"0",prop:"payOfPayment"}},[o("el-select",{model:{value:e.estateRoomDetail.hostingRooms[a].payOfPayment,callback:function(t){e.$set(e.estateRoomDetail.hostingRooms[a],"payOfPayment",t)},expression:"estateRoomDetail.hostingRooms[index].payOfPayment"}},e._l(e.payList,function(e){return o("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1)],1),e._v(" "),o("el-col",{staticClass:"inline-item-label",attrs:{span:1}},[e._v("\n            押\n          ")]),e._v(" "),o("el-col",{attrs:{span:4}},[o("el-form-item",{staticClass:"room-item-count",attrs:{label:"","label-width":"0",prop:"depositOfPayment"}},[o("el-select",{on:{change:function(t){e.handleDepositChange(e.estateRoomDetail)}},model:{value:e.estateRoomDetail.hostingRooms[a].depositOfPayment,callback:function(t){e.$set(e.estateRoomDetail.hostingRooms[a],"depositOfPayment",t)},expression:"estateRoomDetail.hostingRooms[index].depositOfPayment"}},e._l(e.depositList,function(e){return o("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1)],1)],1),e._v(" "),o("el-row",{attrs:{gutter:20}},[o("el-col",{attrs:{span:7}},[o("el-form-item",{attrs:{label:"租金"}},[o("el-input",{attrs:{placeholder:"请输入租金",type:"number",clearable:""},on:{change:function(t){e.handleRentChange(e.estateRoomDetail.hostingRooms[a])}},model:{value:e.estateRoomDetail.hostingRooms[a].rent,callback:function(t){e.$set(e.estateRoomDetail.hostingRooms[a],"rent",t)},expression:"estateRoomDetail.hostingRooms[index].rent"}})],1)],1),e._v(" "),o("el-col",{staticClass:"inline-item-label",staticStyle:{"text-align":"left"},attrs:{span:1}},[e._v("\n            元/月\n          ")])],1),e._v(" "),o("el-row",[o("el-col",{attrs:{span:6}},[o("el-form-item",{attrs:{label:"押金"}},[o("el-input",{attrs:{disabled:13!==e.estateRoomDetail.hostingRooms[a].depositOfPayment,type:"number"},model:{value:e.estateRoomDetail.hostingRooms[a].deposit,callback:function(t){e.$set(e.estateRoomDetail.hostingRooms[a],"deposit",t)},expression:"estateRoomDetail.hostingRooms[index].deposit"}})],1)],1),e._v(" "),o("el-col",{staticClass:"inline-item-label",attrs:{span:1}},[e._v("\n              元`\n          ")])],1),e._v(" "),o("el-row",[o("el-form-item",{staticClass:"room-item-count",attrs:{label:"上传图片",prop:"pictures"}},[o("uploadImg")],1)],1),e._v(" "),o("el-row",[o("el-form-item",{attrs:{label:"房号配置"}},[o("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.selectRoomNum}},[e._v("\n              房间号配置\n            ")])],1)],1)],1)],1)})),e._v(" "),o("el-dialog",{attrs:{visible:e.roomCheckbox,title:"选择房间号"},on:{"update:visible":function(t){e.roomCheckbox=t}}},[o("room-check-group")],1)],1)},[],!1,null,null,null);i.options.__file="roomType.vue";t.default=i.exports},Hd8I:function(e,t,o){},"I/sX":function(e,t,o){},KspW:function(e,t,o){"use strict";o.r(t);var a=o("m1cH"),s=o.n(a),i=o("14Xm"),l=o.n(i),n=o("EJiy"),r=o.n(n),c=o("4d7F"),m=o.n(c),u=o("D3Ub"),d=o.n(u),p=o("vXZP"),h=o("9esu"),f={name:"UploadImg",components:{Preview:p.a,ImageCropper:h.a},data:function(){return{estateRoomDetail:{pictures:[]},uploadPicsModelVisible:!1,curPicListIndex:-1,currentPicList:[],cropperList:[],accept:"image/png, image/jpeg, image/jpg"}},methods:{uploadImg:function(e){var t=this;return d()(l.a.mark(function o(){var a,s,i,n,c;return l.a.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(e.target.value){o.next=2;break}return o.abrupt("return",!1);case 2:if(a=[],s=function(e){return new m.a(function(t){var o=new FileReader;o.onerror=function(e){console.log("读取异常....")},o.onload=function(o){var a="object"===r()(o.target.result)?window.URL.createObjectURL(new Blob([o.target.result])):o.target.result,s="";s=e.name?e.name.split(".")[0].length<=30?e.name.split(".")[0]:e.name.split(".")[0].substr(0,30):"",t({img:a,imageName:s,type:1})},o.readAsDataURL(e)})},i=e.target.files,!((n=t.currentPicList).length+i.length>15)){o.next=10;break}return t.$message.error("您已上传"+n.length+"张图片，最多还能上传"+(15-n.length)+"张图片"),e.target.value=null,o.abrupt("return",!1);case 10:c=0;case 11:if(!(c<i.length)){o.next=24;break}if(t.accept.includes(i[c].type)){o.next=16;break}return t.$message.error("请上传"+t.accept.replace(/image\//gi,"")+"的图片"),e.target.value=null,o.abrupt("return",!1);case 16:return o.t0=a,o.next=19,s(i[c]);case 19:o.t1=o.sent,o.t0.push.call(o.t0,o.t1);case 21:c++,o.next=11;break;case 24:console.log("e.target.files",e.target.files),t.cropperList=a.map(function(e,t){return{img:e.img,imageName:e.imageName,type:e.type}}),e.target.value=null;case 27:case"end":return o.stop()}},o,t)}))()},openPicModel:function(e){this.curPicListIndex=e,this.currentPicList=-1===e?this.estateRoomDetail.pictures:this.estateRoomDetail.hostingRooms[e].pictures,this.uploadPicsModelVisible=!0},emitDelete:function(e){this.currentPicList=e||[]},emitCropperData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];console.log("list1",e),e.forEach(function(e,t){e.type=1,e.imageName=e.title,void 0===e.isBase64&&(e.isBase64=1)}),console.log("list2",e),this.currentPicList=[].concat(s()(this.currentPicList),s()(e)),console.log("上传图片组件中的",this.currentPicList)},uploadModelClose:function(){-1===this.curPicListIndex?this.estateRoomDetail.pictures=this.currentPicList:this.estateRoomDetail.hostingRooms[this.curPicListIndex].pictures=this.currentPicList,console.log("cc",this.estateRoomDetail.pictures),this.currentPicList=[]}}},g=(o("2kZ5"),o("KHd+")),b=Object(g.a)(f,function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[e.estateRoomDetail.pictures.length?o("el-badge",{attrs:{value:e.estateRoomDetail.pictures.length}},[o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){e.openPicModel()}}},[e._v("上传照片")])],1):o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){e.openPicModel()}}},[e._v("上传照片")]),e._v(" "),o("el-dialog",{attrs:{visible:e.uploadPicsModelVisible,"append-to-body":"",title:"上传公寓照片","custom-class":"upload-pics-model",width:"600px"},on:{"update:visible":function(t){e.uploadPicsModelVisible=t},close:e.uploadModelClose}},[o("div",{staticClass:"previewItems"},[o("Preview",{attrs:{"pic-list":e.currentPicList,"delete-icon":!0,disabled:!1},on:{emitDelete:e.emitDelete}}),e._v(" "),o("label",{staticClass:"el-upload el-upload--picture-card uploadImage",attrs:{for:"uploadImages"}},[o("i",{staticClass:"el-icon-plus"}),e._v(" "),o("input",{attrs:{id:"uploadImages",accept:e.accept,type:"file",multiple:""},on:{change:function(t){e.uploadImg(t)}}})])],1),e._v(" "),o("p",{staticClass:"upload-pics-info"},[e._v("温馨提示： ")]),e._v(" "),o("p",{staticClass:"upload-pics-info"},[e._v("1.请勿上传虚假、模糊、与房源信息无关、含有其他公司水印的照片； ")]),e._v(" "),o("p",{staticClass:"upload-pics-info"},[e._v("2.房间照片最佳组合：卧室2~6张、公共区域1~4张、厨房1~3张、卫生间1-4张； ")]),e._v(" "),o("p",{staticClass:"upload-pics-info"},[e._v("3.目前最多支持15张，支持JPG/JPEG/PNG，可以拖动图片进行排序，支持批量上传。")]),e._v(" "),o("ImageCropper",{attrs:{"cropper-list":e.cropperList},on:{emitCropperData:e.emitCropperData}}),e._v(" "),o("span",{attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){e.uploadPicsModelVisible=!1}}},[e._v("关 闭")])],1)],1)],1)},[],!1,null,null,null);b.options.__file="uploadImg.vue";t.default=b.exports},KvgY:function(e,t,o){},Owq5:function(e,t,o){"use strict";var a=o("lIRj");o.n(a).a},"TO+e":function(e,t,o){"use strict";o.r(t);var a=o("gDS+"),s=o.n(a),i=o("m1cH"),l=o.n(i),n=o("14Xm"),r=o.n(n),c=o("EJiy"),m=o.n(c),u=o("4d7F"),d=o.n(u),p=o("D3Ub"),h=o.n(p),f=o("sk9p"),g=o.n(f),b=o("7Qib"),R=o("vXZP"),v=o("qS2N"),y=o("KBld"),D=o("+zbL"),C=o("n6Nk"),_=o("Yfch"),k=o("9esu"),x=o("TYJK"),L=o("EKBX"),N={name:"EstateRoomDetail",components:{mapSelect:y.a,areaSelect:v.a,SelectTree:D.a,ImageCropper:k.a,Preview:R.a,roomType:L.default,validateMobile:_.a,roomListSelect:x.default},inject:["reloadPage"],data:function(){var e=this;return{copyItemToModelVisible:!1,copyItemRoomList:{},curRoomList:{},roomTotal:0,currentRoomIndex:null,zoneList:[],saveLoading:!1,saveEasteLoading:!1,editFlag:!1,addHouseType:!1,defaultCheckObj:[],cancelDefaultCheckObj:[],checkedRoomList:[],toRouter:!1,estateRoomDetail:{fangyuanCode:"",contactName:"",contactGender:1,contactMobile:"",estateName:"",areaCode:[],houseDesc:"",zoneId:"",pictures:[],floorName:[],floorRoomNum:"",apartmentFloor:null},address:"",addHostingRooms:{depId:null,fangyuanCode:"",hostingRooms:[{styleName:"",roomArea:"",elTabName:"房型A",roomDirection:"",chamberCount:"1",boardCount:"0",toiletCount:"0",name:"1",rent:"",deposit:"",payOfPayment:"",depositOfPayment:"",facilityItems:"",pictures:[],roomCodes:[]}]},facilityItemsList:[{facilityItems:""}],estateRoomDetailRules:{depName:[{required:!0,trigger:["change"],validator:function(e,t,o){t?o():o(new Error("请选择归属部门"))}}],address:[{required:!0,trigger:"change",validator:function(t,o,a){e.address?a():a(new Error(" 请输入关键字 "))}}],estateName:[{required:!0,message:"请输入品牌公寓",trigger:"blur"}],contactName:[{required:!0,message:"请输入联系人姓名",trigger:"blur"}],contactMobile:[{required:!0,trigger:"blur",validator:function(e,t,o){Object(_.a)(t)?o():o(new Error("请输入正确的手机号"))}}],houseDesc:[{required:!0,message:"请输入房源描述",trigger:"blur"},{max:150,message:"长度不能超过150个字符",trigger:"change"}],apartmentFloor:[{required:!0,trigger:"blur",validator:function(t,o,a){e.estateRoomDetail.apartmentFloor?"0"===e.estateRoomDetail.apartmentFloor?a(new Error("楼层数不能为0")):a():a(new Error(" 请输入楼层数"))}}],floorRoomNum:[{required:!0,message:"请输入每层房间数",trigger:"blur"}],floorName:[{required:!0,message:"请选择楼层",trigger:"change"}],areaCode:[{required:!0,validator:function(e,t,o){t[0]?o():o(new Error("请选择所在地区"))},trigger:"change"}],pictures:[{required:!0,validator:function(e,t,o){t.length?o():o(new Error("请上传房间照片"))}}]},roomDetailRules:{styleName:[{required:!0,message:"请输入房源类型",trigger:"blur"}],roomArea:[{required:!0,message:"请输入房源面积",trigger:"blur"}],chamberCount:[{required:!0,message:"请输入室",trigger:"blur"}],roomDirection:[{required:!0,message:"请选择房屋朝向",trigger:"change"}],payOfPayment:[{required:!0,message:"请输入付款方式",trigger:"change"}],depositOfPayment:[{required:!0,message:"请选择押金方式",trigger:"change"}],rent:[{required:!0,message:"请输入租金",trigger:"blur"}],deposit:[{required:!0,message:"请输入押金",trigger:"blur"}],pictures:[{required:!0,validator:function(e,t,o){t.length?o():o(new Error("请上传房间照片"))}}]},floorOptions:[],allRoomByFangyuanCode:[],activeRoomName:"1",tabIndex:1,editableTabsValue:"1",clearDepName:!0,expendedKeys:{depId:Number,depName:""},toolsWidth:{type:String,default:"100%"},roomDirectionList:[{label:"朝南",value:1},{label:"朝北",value:2},{label:"朝东",value:3},{label:"朝西",value:4},{label:"东南",value:5},{label:"西南",value:6},{label:"东北",value:7},{label:"西北",value:8}],facilityGroup:[{label:"家电",facilitys:[{value:"2",label:"洗衣机"},{value:"3",label:"空调"},{value:"4",label:"冰箱"},{value:"5",label:"电视"}]},{label:"家具",facilitys:[{value:"1",label:"床"},{value:"7",label:"沙发"},{value:"8",label:"茶几"},{value:"10",label:"餐桌"}]},{label:"其他",facilitys:[{value:"6",label:"宽带"}]}],roomCheckbox:!1,uploadPicsModelVisible:!1,curPicListIndex:-1,currentPicList:[],cropperList:[],accept:"image/png, image/jpeg, image/jpg",estateModel:{},changeEditFloor:!1}},computed:{payList:function(){for(var e=[],t=0;t<13;t++)e.push({value:t,label:t+""});return e},depositList:function(){var e=this.payList.slice(0);return e.push({value:13,label:"自定义"}),e},apartmentFloor:function(){return this.estateRoomDetail.apartmentFloor}},watch:{apartmentFloor:function(e,t){this.changeEditFloor=!0}},methods:{apartmentFocus:function(){this.changeEditFloor=!1},apartmentInput:function(){if(this.floorOptions=[],this.estateRoomDetail.apartmentFloor)for(var e=1;e<=this.estateRoomDetail.apartmentFloor;e++)this.floorOptions.push({value:e,label:e+"层"});this.changeEditFloor&&(this.estateRoomDetail.floorName=[])},clickTreeNode:function(e){console.log(e),this.$set(this.estateRoomDetail,"depName",e.depName),this.addHostingRooms.depId=e.depId},getParentDep:function(e){this.expendedKeys=Object(b.b)(e)},clearClick:function(){this.$set(this.estateRoomDetail,"depName","")},searchZoneList:function(e){var t=this,o=g()(this.estateRoomDetail.areaCode,3);this.estateRoomDetail.provinceId=o[0],this.estateRoomDetail.cityId=o[1],this.estateRoomDetail.regionId=o[2],e||(this.estateRoomDetail.regionAddressId="",this.estateRoomDetail.zoneId="",this.address=""),void 0!==this.estateRoomDetail.areaCode[2]?Object(C.n)({regionId:this.estateRoomDetail.regionId}).then(function(e){t.zoneList=e.data.list}):this.zoneList=[]},addressChange:function(e){console.log(e),e.areaCode&&(this.estateRoomDetail.areaCode=e.areaCode),this.estateRoomDetail.regionAddressId=e.regionAddressId,this.address=e.address,this.$refs.estateRoomDetail.validateField("address"),this.searchZoneList(!0)},handleTabsEdit:function(e,t){var o=this;if("add"===t){if(this.addHostingRooms.hostingRooms.length>25)return;var a=this.addHostingRooms.hostingRooms.length,s=++this.tabIndex+"";this.addHostingRooms.hostingRooms.push({styleName:"",roomArea:"",elTabName:"房型"+"ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("")[a],roomDirection:"",chamberCount:"1",boardCount:"0",toiletCount:"0",rent:"",deposit:"",name:s,payOfPayment:"",depositOfPayment:"",facilityItems:"",pictures:[],roomCodes:[]}),this.facilityItemsList.push({facilityItems:""}),this.editableTabsValue=s}if("remove"===t){var i=this.addHostingRooms.hostingRooms,l=this.editableTabsValue;l===e&&i.forEach(function(t,a){if(t.name===e){var s=i[a+1]||i[a-1];o.defaultCheckObj.splice(a,1),s&&(l=s.name)}}),this.editableTabsValue=l,this.addHostingRooms.hostingRooms=i.filter(function(t){return t.name!==e}),this.addHostingRooms.hostingRooms.forEach(function(e,t){e.elTabName="房型"+"ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("")[t]}),this.$nextTick(function(){o.activeRoomName=l,o.editableTabsValue=l})}},handleRoomNameLength:function(e){e.styleName&&e.styleName.length>10&&(e.styleName=e.styleName.substr(0,10))},deleteCurRoom:function(e,t){console.log(e.name),this.handleTabsEdit(e.name,"remove")},setPrecision:function(e,t){var o="number"==typeof e?this.addHostingRooms.hostingRooms[e].roomArea:"";o>0?o.split(".")[1]?o=Number(o).toFixed(2):o+=".00":o=0;this.addHostingRooms.hostingRooms[e].roomArea=o},handleDepositChange:function(e){if(13!==e.depositOfPayment){if(""===e.rent)return void(e.deposit="");if(e.deposit=e.rent*e.depositOfPayment,e.deposit=0===e.deposit?0:e.deposit.toFixed(2),e.elTabName){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZ".indexOf(e.elTabName.replace("房型",""));this.$refs.roomTypeTabsForm.validateField("hostingRooms."+t+".deposit")}}},handleRentChange:function(e){e.rent>0?(e.rent=Math.min(1e5,e.rent).toString(),e.rent.split(".")[1]?e.rent=Number(e.rent).toFixed(2):e.rent=e.rent+".00"):e.rent=0;if(""!==e.rent&&""!==e.depositOfPayment&&13!==e.depositOfPayment?(e.deposit=e.rent*e.depositOfPayment,e.deposit=0===e.deposit?0:e.deposit.toFixed(2)):e.deposit="",""!==e.depositOfPayment&&e.elTabName){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZ".indexOf(e.elTabName.replace("房型",""));this.$refs.roomTypeTabsForm.validateField("hostingRooms."+t+".deposit")}},getFacilityItems:function(e){console.log("房间设施",this.facilityItemsList[e].facilityItems),this.addHostingRooms.hostingRooms[e].facilityItems=this.facilityItemsList[e].facilityItems.join(",")},uploadImg:function(e){var t=this;return h()(r.a.mark(function o(){var a,s,i,l,n;return r.a.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(e.target.value){o.next=2;break}return o.abrupt("return",!1);case 2:if(a=[],s=function(e){return new d.a(function(t){var o=new FileReader;o.onerror=function(e){console.log("读取异常....")},o.onload=function(o){var a="object"===m()(o.target.result)?window.URL.createObjectURL(new Blob([o.target.result])):o.target.result,s="";s=e.name?e.name.split(".")[0].length<=30?e.name.split(".")[0]:e.name.split(".")[0].substr(0,30):"",t({img:a,imageName:s,type:1})},o.readAsDataURL(e)})},i=e.target.files,!((l=t.currentPicList).length+i.length>15)){o.next=10;break}return t.$message.error("您已上传"+l.length+"张图片，最多还能上传"+(15-l.length)+"张图片"),e.target.value=null,o.abrupt("return",!1);case 10:n=0;case 11:if(!(n<i.length)){o.next=24;break}if(t.accept.includes(i[n].type)){o.next=16;break}return t.$message.error("请上传"+t.accept.replace(/image\//gi,"")+"的图片"),e.target.value=null,o.abrupt("return",!1);case 16:return o.t0=a,o.next=19,s(i[n]);case 19:o.t1=o.sent,o.t0.push.call(o.t0,o.t1);case 21:n++,o.next=11;break;case 24:t.cropperList=a.map(function(e,t){return{img:e.img,imageName:e.imageName,type:e.type}}),e.target.value=null;case 26:case"end":return o.stop()}},o,t)}))()},openPicModel:function(e){this.curPicListIndex=e,this.currentPicList=-1===e?this.estateRoomDetail.pictures:this.addHostingRooms.hostingRooms[e].pictures,this.uploadPicsModelVisible=!0},emitDelete:function(e){this.currentPicList=e||[]},emitCropperData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];e.forEach(function(e,t){e.type=1,e.imageName=e.title,void 0===e.isBase64&&(e.isBase64=1)}),this.currentPicList=[].concat(l()(this.currentPicList),l()(e))},uploadModelClose:function(){-1===this.curPicListIndex?(this.estateRoomDetail.pictures=this.currentPicList,this.$refs.estateRoomDetail.validateField("pictures")):(this.addHostingRooms.hostingRooms[this.curPicListIndex].pictures=this.currentPicList,this.$refs.roomTypeTabsForm.validateField("hostingRooms."+this.curPicListIndex+".pictures")),this.currentPicList=[]},addEstateRoomNext:function(){var e=this,t=[];this.$refs.estateRoomDetail.validate(function(o){if(o){e.saveEasteLoading=!0,e.estateRoomDetail.floorName.forEach(function(o,a){t.push({floorName:o,roomNum:e.estateRoomDetail.floorRoomNum})});var a={fangyuanCode:e.estateRoomDetail.fangyuanCode,contactGender:e.estateRoomDetail.contactGender,contactMobile:e.estateRoomDetail.contactMobile,contactName:e.estateRoomDetail.contactName,estateName:e.estateRoomDetail.estateName,regionAddressId:e.estateRoomDetail.regionAddressId,houseDesc:e.estateRoomDetail.houseDesc,zoneId:e.estateRoomDetail.zoneId,floors:t,pictures:e.estateRoomDetail.pictures};console.log("提交公寓的参数",a);var i=s()(a);Object(C.x)({estateInfo:i}).then(function(t){1*t.code==0?(e.estateRoomDetail.fangyuanCode=t.data,e.roomTotal=e.estateRoomDetail.floorName.length*e.estateRoomDetail.floorRoomNum,Object(C.a)({fangyuanCode:t.data}).then(function(t){e.copyItemRoomList=t.data,e.addHouseType=!0,e.saveEasteLoading=!1})):(e.fullscreenLoading=!1,e.$message({message:t.message,type:"warning"}))}).catch(function(){e.saveEasteLoading=!1})}})},addEstateRoomPrev:function(){this.addHostingRooms.hostingRooms=[{roomTypes:"",roomArea:"",elTabName:"房型A",roomDirection:"",chamberCount:"1",boardCount:"0",toiletCount:"0",name:"1",rent:"",deposit:"",payOfPayment:"",depositOfPayment:"",facilityItems:"",pictures:[],roomCodes:[]}],this.facilityItemsList=[{facilityItems:""}],this.editableTabsValue="1",this.tabIndex=1,this.$refs.estateRoomDetail.clearValidate(),this.defaultCheckObj=[];for(var e=0;e<this.addHostingRooms.hostingRooms.length;e++)this.addHostingRooms.hostingRooms[e].roomCodes=[];this.addHostingRooms.hostingRooms.splice(2,this.addHostingRooms.hostingRooms.length),this.addHouseType=!1},selectRoomNum:function(e){var t=this;this.copyItemToModelVisible=!0;var o=[];if(this.currentRoomIndex=e,this.cancelDefaultCheckObj=Object(b.b)(this.defaultCheckObj),this.cancelDefaultCheckObj.splice(e,1),this.cancelDefaultCheckObj.filter(function(e,t){e.forEach(function(e,t){o.push(e)})}),this.curRoomList=Object(b.b)(this.copyItemRoomList),o.length){var a=function(e){t.curRoomList[e].map(function(a,s){o.forEach(function(o){o===a.roomCode&&(t.curRoomList[e][s]=0)})})};for(var s in this.curRoomList)a(s)}var i=function(e){t.curRoomList[e]=t.curRoomList[e].filter(function(o){return 0!==t.curRoomList[e][o]})};for(var l in this.curRoomList)i(l)},getRoomNumData:function(){this.checkedRoomList=this.$refs.copyItemTo[this.currentRoomIndex].returnCheckedList().saveRoomList,this.defaultCheckObj[this.currentRoomIndex]=this.checkedRoomList||[],this.addHostingRooms.hostingRooms[this.currentRoomIndex].roomCodes=Object(b.b)(this.checkedRoomList),this.copyItemToModelVisible=!1},defaultCheckObjNum:function(e){for(var t=0,o=0;o<this.defaultCheckObj.length;o++)t+=this.defaultCheckObj[o].length;return t!==this.roomTotal},saveRoomDetailData:function(e){var t=this,o={};o.depId=this.addHostingRooms.depId,o.fangyuanCode=this.estateRoomDetail.fangyuanCode,console.log("保存房型参数",this.addHostingRooms.hostingRooms),o.roomTypes=s()(this.addHostingRooms.hostingRooms),this.$refs.roomTypeTabsForm.validate(function(a){a&&(t.saveLoading=!0,t.defaultCheckObjNum(1)?t.$message({message:"部分房间还未配置,请继续配置剩余房间号",type:"warning"}):1===e?Object(C.y)(o).then(function(e){console.log("跳转1"),t.saveLoading=!1,t.reloadPage(),t.toRouter=!0}).catch(function(){t.saveLoading=!1}):3===e&&Object(C.y)(o).then(function(e){console.log("跳转2"),t.saveLoading=!1,t.toRouter=!0,t.$router.push({name:"集中式房源管理"})}).catch(function(){t.saveLoading=!1}))}),2===e&&Object(C.e)({fangyuanCode:this.estateRoomDetail.fangyuanCode}).then(function(e){t.$router.push({name:"集中式房源管理"})})}},beforeRouteLeave:function(e,t,o){""===this.estateRoomDetail.fangyuanCode||this.toRouter?o():Object(C.e)({fangyuanCode:this.estateRoomDetail.fangyuanCode}).then(function(e){o()})}},I=(o("DqvW"),o("oYfu"),o("KHd+")),P=Object(I.a)(N,function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"estate"},[e._m(0),e._v(" "),o("div",{staticClass:"layout-container"},[o("div",{directives:[{name:"loading",rawName:"v-loading",value:e.saveEasteLoading,expression:"saveEasteLoading"}],staticClass:"entry-house-container"},[o("el-form",{ref:"estateRoomDetail",staticClass:"room-detail-container hosting-room-detail",attrs:{model:e.estateRoomDetail,rules:e.estateRoomDetailRules,"label-width":"95px",size:"small"}},[o("div",{directives:[{name:"show",rawName:"v-show",value:!e.addHouseType,expression:"!addHouseType"}]},[o("el-form-item",{staticClass:"item-input",attrs:{label:"归属部门",prop:"depName"}},[o("SelectTree",{attrs:{"expanded-keys":e.expendedKeys,"clear-dep-name":e.clearDepName,value:e.estateRoomDetail.depName,"node-key":"depId"},on:{treeNodeClick:e.clickTreeNode,getParentDep:e.getParentDep,clearClick:e.clearClick}})],1),e._v(" "),o("el-form-item",{staticClass:"item-input",attrs:{label:"所在地区",prop:"areaCode"}},[o("area-select",{ref:"areaSelect",attrs:{level:1},on:{input:function(t){e.searchZoneList(!1)}},model:{value:e.estateRoomDetail.areaCode,callback:function(t){e.$set(e.estateRoomDetail,"areaCode",t)},expression:"estateRoomDetail.areaCode"}})],1),e._v(" "),o("el-form-item",{attrs:{rules:{required:e.zoneList.length>0,message:"请选择所属板块",trigger:"change"},prop:"zoneId",label:"所属板块"}},[o("el-select",{staticStyle:{width:"43%"},attrs:{placeholder:e.zoneList.length?"请选择":"无"},model:{value:e.estateRoomDetail.zoneId,callback:function(t){e.$set(e.estateRoomDetail,"zoneId",t)},expression:"estateRoomDetail.zoneId"}},e._l(e.zoneList,function(e){return o("el-option",{key:e.zoneId,attrs:{label:e.zoneName,value:e.zoneId}})}))],1),e._v(" "),o("el-form-item",{staticClass:"item-input",attrs:{label:"具体位置",prop:"address"}},[o("map-select",{attrs:{"area-code":e.estateRoomDetail.areaCode,value:e.address},on:{addressChange:e.addressChange}})],1),e._v(" "),o("el-form-item",{staticClass:"item-input",attrs:{label:"品牌公寓",prop:"estateName"}},[o("el-input",{attrs:{placeholder:"请输入品牌公寓名称"},model:{value:e.estateRoomDetail.estateName,callback:function(t){e.$set(e.estateRoomDetail,"estateName",t)},expression:"estateRoomDetail.estateName"}})],1),e._v(" "),o("el-row",{attrs:{gutter:20}},[o("el-col",{attrs:{span:8}},[o("el-form-item",{attrs:{prop:"contactName",label:"看房电话"}},[o("el-input",{attrs:{placeholder:"联系人"},model:{value:e.estateRoomDetail.contactName,callback:function(t){e.$set(e.estateRoomDetail,"contactName",t)},expression:"estateRoomDetail.contactName"}})],1)],1),e._v(" "),o("el-col",{attrs:{span:3}},[o("el-form-item",{attrs:{"label-width":"0"}},[o("el-select",{model:{value:e.estateRoomDetail.contactGender,callback:function(t){e.$set(e.estateRoomDetail,"contactGender",t)},expression:"estateRoomDetail.contactGender"}},[o("el-option",{attrs:{value:1,label:"先生"}}),e._v(" "),o("el-option",{attrs:{value:2,label:"女士"}})],1)],1)],1),e._v(" "),o("el-col",{attrs:{span:6}},[o("el-form-item",{attrs:{prop:"contactMobile","label-width":"0"}},[o("el-input",{attrs:{placeholder:"联系电话"},model:{value:e.estateRoomDetail.contactMobile,callback:function(t){e.$set(e.estateRoomDetail,"contactMobile",t)},expression:"estateRoomDetail.contactMobile"}})],1)],1)],1),e._v(" "),o("el-form-item",{attrs:{label:"公寓照片",prop:"pictures"}},[e.estateRoomDetail.pictures.length?o("el-badge",{attrs:{value:e.estateRoomDetail.pictures.length}},[o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){e.openPicModel(-1)}}},[e._v("上传照片")])],1):o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){e.openPicModel(-1)}}},[e._v("上传照片")])],1),e._v(" "),o("el-form-item",{attrs:{label:"公寓楼层",prop:"apartmentFloor"}},[o("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入楼层"},on:{blur:e.apartmentInput,focus:e.apartmentFocus},model:{value:e.estateRoomDetail.apartmentFloor,callback:function(t){e.$set(e.estateRoomDetail,"apartmentFloor",t)},expression:"estateRoomDetail.apartmentFloor"}},[o("template",{slot:"prepend"},[e._v("共")]),e._v(" "),o("template",{slot:"append"},[e._v("层")])],2)],1),e._v(" "),o("el-form-item",{attrs:{label:"编辑楼层",prop:"floorName"}},[o("el-select",{staticStyle:{width:"43%"},attrs:{multiple:"","allow-create":"","default-first-option":"",placeholder:"请选择楼层"},model:{value:e.estateRoomDetail.floorName,callback:function(t){e.$set(e.estateRoomDetail,"floorName",t)},expression:"estateRoomDetail.floorName"}},e._l(e.floorOptions,function(e){return o("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),o("el-form-item",{attrs:{label:"每层房间数",prop:"floorRoomNum"}},[o("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入内容"},model:{value:e.estateRoomDetail.floorRoomNum,callback:function(t){e.$set(e.estateRoomDetail,"floorRoomNum",t)},expression:"estateRoomDetail.floorRoomNum"}},[o("template",{slot:"append"},[e._v("间")])],2)],1),e._v(" "),o("el-row",{attrs:{gutter:20}},[o("el-col",{attrs:{span:24}},[o("el-form-item",{attrs:{label:"公寓简介",prop:"houseDesc"}},[o("el-input",{attrs:{rows:5,type:"textarea",placeholder:"请描述一下房源的交通、装饰、周边设施场所等等…"},model:{value:e.estateRoomDetail.houseDesc,callback:function(t){e.$set(e.estateRoomDetail,"houseDesc",t)},expression:"estateRoomDetail.houseDesc"}}),e._v(" "),o("span",{staticClass:"estate-iontro-length-tips"},[e._v(e._s(e.estateRoomDetail.houseDesc.length)+"/150")])],1)],1)],1)],1),e._v(" "),o("el-dialog",{attrs:{visible:e.uploadPicsModelVisible,"append-to-body":"",title:"上传公寓照片","custom-class":"upload-pics-model",width:"600px"},on:{"update:visible":function(t){e.uploadPicsModelVisible=t},close:e.uploadModelClose}},[o("div",{staticClass:"previewItems"},[o("Preview",{attrs:{"pic-list":e.currentPicList,"delete-icon":!0,disabled:!1},on:{emitDelete:e.emitDelete}}),e._v(" "),o("label",{staticClass:"el-upload el-upload--picture-card uploadImage",attrs:{for:"uploadImages"}},[o("i",{staticClass:"el-icon-plus"}),e._v(" "),o("input",{attrs:{id:"uploadImages",accept:e.accept,type:"file",multiple:""},on:{change:function(t){e.uploadImg(t)}}})])],1),e._v(" "),o("p",{staticClass:"upload-pics-info"},[e._v("温馨提示： ")]),e._v(" "),o("p",{staticClass:"upload-pics-info"},[e._v("1.请勿上传虚假、模糊、与房源信息无关、含有其他公司水印的照片； ")]),e._v(" "),o("p",{staticClass:"upload-pics-info"},[e._v("2.房间照片最佳组合：卧室2~6张、公共区域1~4张、厨房1~3张、卫生间1-4张； ")]),e._v(" "),o("p",{staticClass:"upload-pics-info"},[e._v("3.目前最多支持15张，支持JPG/JPEG/PNG，可以拖动图片进行排序，支持批量上传。")]),e._v(" "),o("ImageCropper",{attrs:{"cropper-list":e.cropperList},on:{emitCropperData:e.emitCropperData}}),e._v(" "),o("span",{attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){e.uploadPicsModelVisible=!1}}},[e._v("关 闭")])],1)],1)],1),e._v(" "),o("el-form",{ref:"roomTypeTabsForm",staticClass:"room-detail-container hosting-room-detail",attrs:{model:e.addHostingRooms,rules:e.roomDetailRules,"label-width":"95px",size:"small"}},[e.addHouseType?o("el-tabs",{staticClass:"sub-room-info-list",attrs:{type:"border-card",editable:""},on:{edit:e.handleTabsEdit},model:{value:e.editableTabsValue,callback:function(t){e.editableTabsValue=t},expression:"editableTabsValue"}},e._l(e.addHostingRooms.hostingRooms,function(t,a){return o("el-tab-pane",{key:a,attrs:{name:t.name}},[o("span",{attrs:{slot:"label"},slot:"label"},[e._v(e._s(t.elTabName)+"\n              "),o("i",{directives:[{name:"show",rawName:"v-show",value:a===e.addHostingRooms.hostingRooms.length-1&&a>0,expression:"index === addHostingRooms.hostingRooms.length - 1 && index > 0"}],staticClass:"el-icon-delete",on:{click:function(o){e.deleteCurRoom(t,a)}}})]),e._v(" "),o("el-row",{attrs:{gutter:0}},[o("el-col",{staticClass:"inline-item-label",attrs:{span:10}},[o("el-form-item",{attrs:{prop:"hostingRooms."+a+".styleName",rules:e.roomDetailRules.styleName,label:"房间类型"}},[o("el-input",{attrs:{placeholder:"请输入房源类型",clearable:""},on:{change:function(t){e.handleRoomNameLength(e.addHostingRooms.hostingRooms[a])}},nativeOn:{keyup:function(t){e.handleRoomNameLength(e.addHostingRooms.hostingRooms[a])}},model:{value:e.addHostingRooms.hostingRooms[a].styleName,callback:function(t){e.$set(e.addHostingRooms.hostingRooms[a],"styleName",t)},expression:"addHostingRooms.hostingRooms[index].styleName"}})],1)],1)],1),e._v(" "),o("el-row",[o("el-col",{attrs:{span:10}},[o("el-form-item",{staticClass:"room-item-count",attrs:{prop:"hostingRooms."+a+".roomArea",rules:e.roomDetailRules.roomArea,label:"房间面积"}},[o("el-input",{attrs:{placeholder:"请输入房间面积",min:"0",clearable:"",type:"number"},on:{change:function(t){e.setPrecision(a)}},model:{value:e.addHostingRooms.hostingRooms[a].roomArea,callback:function(t){e.$set(e.addHostingRooms.hostingRooms[a],"roomArea",t)},expression:"addHostingRooms.hostingRooms[index].roomArea"}})],1)],1),e._v(" "),o("el-col",{staticClass:"inline-item-label",attrs:{span:4}},[e._v("\n                 m\n                "),o("sup",[e._v("2")])])],1),e._v(" "),o("el-row",{attrs:{gutter:10}},[o("el-col",{attrs:{span:3}},[o("el-form-item",{attrs:{rules:e.roomDetailRules.chamberCount,"show-message":!1,label:"户型"}})],1),e._v(" "),o("el-col",{attrs:{span:3}},[o("el-form-item",{staticClass:"room-item-count",staticStyle:{"margin-left":"-8px"},attrs:{prop:"hostingRooms."+a+".chamberCount",rules:e.roomDetailRules.chamberCount,label:"","label-width":"0"}},[o("el-select",{attrs:{placeholder:""},model:{value:e.addHostingRooms.hostingRooms[a].chamberCount,callback:function(t){e.$set(e.addHostingRooms.hostingRooms[a],"chamberCount",t)},expression:"addHostingRooms.hostingRooms[index].chamberCount"}},e._l(10,function(e,t){return o("el-option",{key:e,attrs:{value:t}})}))],1)],1),e._v(" "),o("el-col",{staticClass:"inline-item-label",attrs:{span:1}},[e._v("\n                室\n              ")]),e._v(" "),o("el-col",{attrs:{span:3}},[o("el-form-item",{staticClass:"room-item-count",attrs:{label:"","label-width":"0",prop:"boardCount"}},[o("el-select",{attrs:{placeholder:""},model:{value:e.addHostingRooms.hostingRooms[a].boardCount,callback:function(t){e.$set(e.addHostingRooms.hostingRooms[a],"boardCount",t)},expression:"addHostingRooms.hostingRooms[index].boardCount"}},e._l(10,function(e,t){return o("el-option",{key:e,attrs:{value:t}})}))],1)],1),e._v(" "),o("el-col",{staticClass:"inline-item-label",attrs:{span:1}},[e._v("\n                厅\n              ")]),e._v(" "),o("el-col",{attrs:{span:3}},[o("el-form-item",{staticClass:"room-item-count",attrs:{label:"","label-width":"0",prop:"toiletCount"}},[o("el-select",{attrs:{placeholder:""},model:{value:e.addHostingRooms.hostingRooms[a].toiletCount,callback:function(t){e.$set(e.addHostingRooms.hostingRooms[a],"toiletCount",t)},expression:"addHostingRooms.hostingRooms[index].toiletCount"}},e._l(10,function(e,t){return o("el-option",{key:e,attrs:{value:t}})}))],1)],1),e._v(" "),o("el-col",{staticClass:"inline-item-label",attrs:{span:1}},[e._v("\n                卫\n              ")]),e._v(" "),o("el-col",{attrs:{span:4}},[o("el-form-item",{staticClass:"room-item-count",attrs:{prop:"hostingRooms."+a+".roomDirection",rules:e.roomDetailRules.roomDirection,"label-width":"0"}},[o("el-select",{staticClass:"room-detail-select",attrs:{placeholder:"朝向"},model:{value:e.addHostingRooms.hostingRooms[a].roomDirection,callback:function(t){e.$set(e.addHostingRooms.hostingRooms[a],"roomDirection",t)},expression:"addHostingRooms.hostingRooms[index].roomDirection"}},e._l(e.roomDirectionList,function(e){return o("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1)],1)],1),e._v(" "),o("el-row",{attrs:{gutter:10}},[o("el-col",{attrs:{span:3}},[o("el-form-item",{attrs:{prop:"hostingRooms."+a+".payOfPayment",rules:e.roomDetailRules.payOfPayment,"show-message":!1,label:"付款方式"}})],1),e._v(" "),o("el-col",{attrs:{span:7}},[o("el-col",{staticClass:"inline-item-label",staticStyle:{"margin-left":"-10px"},attrs:{span:2}},[e._v("\n                  付\n                ")]),e._v(" "),o("el-col",{attrs:{span:10}},[o("el-form-item",{staticClass:"room-item-count",attrs:{prop:"hostingRooms."+a+".payOfPayment",rules:e.roomDetailRules.payOfPayment,"label-width":"0"}},[o("el-select",{model:{value:e.addHostingRooms.hostingRooms[a].payOfPayment,callback:function(t){e.$set(e.addHostingRooms.hostingRooms[a],"payOfPayment",t)},expression:"addHostingRooms.hostingRooms[index].payOfPayment"}},e._l(e.payList,function(e){return o("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1)],1),e._v(" "),o("el-col",{staticClass:"inline-item-label",attrs:{span:3}},[e._v("\n                  押\n                ")]),e._v(" "),o("el-col",{attrs:{span:10}},[o("el-form-item",{staticClass:"room-item-count",attrs:{prop:"hostingRooms."+a+".depositOfPayment",rules:e.roomDetailRules.depositOfPayment,label:"","label-width":"0"}},[o("el-select",{on:{change:function(t){e.handleDepositChange(e.addHostingRooms.hostingRooms[a])}},model:{value:e.addHostingRooms.hostingRooms[a].depositOfPayment,callback:function(t){e.$set(e.addHostingRooms.hostingRooms[a],"depositOfPayment",t)},expression:"addHostingRooms.hostingRooms[index].depositOfPayment"}},e._l(e.depositList,function(e){return o("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1)],1)],1)],1),e._v(" "),o("el-row",[o("el-col",{attrs:{span:8}},[o("el-form-item",{attrs:{prop:"hostingRooms."+a+".rent",rules:e.roomDetailRules.rent,label:"租金"}},[o("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入租金",clearable:""},on:{change:function(t){e.handleRentChange(e.addHostingRooms.hostingRooms[a])}},model:{value:e.addHostingRooms.hostingRooms[a].rent,callback:function(t){e.$set(e.addHostingRooms.hostingRooms[a],"rent",t)},expression:"addHostingRooms.hostingRooms[index].rent"}})],1)],1),e._v(" "),o("el-col",{staticClass:"inline-item-label",staticStyle:{"text-align":"left"},attrs:{span:2}},[e._v("\n                   元/月\n              ")])],1),e._v(" "),o("el-row",[o("el-col",{attrs:{span:8}},[o("el-form-item",{attrs:{prop:"hostingRooms."+a+".deposit",rules:e.roomDetailRules.deposit,label:"押金"}},[o("el-input",{attrs:{disabled:13!==e.addHostingRooms.hostingRooms[a].depositOfPayment,type:"number"},model:{value:e.addHostingRooms.hostingRooms[a].deposit,callback:function(t){e.$set(e.addHostingRooms.hostingRooms[a],"deposit",t)},expression:"addHostingRooms.hostingRooms[index].deposit"}})],1)],1),e._v(" "),o("el-col",{staticClass:"inline-item-label",attrs:{span:1}},[e._v("\n                  元\n              ")])],1),e._v(" "),o("el-row",[o("el-col",{attrs:{span:15}},[o("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"房间设施"}},[o("el-select",{staticClass:"room-detail-select",staticStyle:{width:"82%"},attrs:{multiple:"",placeholder:"请选择"},on:{change:function(t){e.getFacilityItems(a)}},model:{value:e.facilityItemsList[a].facilityItems,callback:function(t){e.$set(e.facilityItemsList[a],"facilityItems",t)},expression:"facilityItemsList[index].facilityItems"}},e._l(e.facilityGroup,function(t){return o("el-option-group",{key:t.label,attrs:{label:t.label}},e._l(t.facilitys,function(e){return o("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))}))],1)],1)],1),e._v(" "),o("el-row",[o("el-col",{attrs:{span:7}},[o("el-form-item",{attrs:{prop:"hostingRooms."+a+".pictures",rules:e.roomDetailRules.pictures,label:"房间照片"}},[e.addHostingRooms.hostingRooms[a].pictures.length>0?[o("el-badge",{attrs:{value:e.addHostingRooms.hostingRooms[a].pictures.length}},[o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){e.openPicModel(a)}}},[e._v("上传照片")])],1)]:[o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){e.openPicModel(a)}}},[e._v("上传照片")])]],2)],1)],1),e._v(" "),o("el-row",[o("el-form-item",{attrs:{label:"房号配置"}},[e.addHostingRooms.hostingRooms[a].roomCodes.length>0?[o("el-badge",{attrs:{value:e.addHostingRooms.hostingRooms[a].roomCodes.length}},[o("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){e.selectRoomNum(a)}}},[e._v("\n                      房间号配置\n                    ")])],1)]:[o("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){e.selectRoomNum(a)}}},[e._v("\n                    房间号配置\n                  ")])]],2)],1),e._v(" "),o("el-dialog",{attrs:{visible:e.copyItemToModelVisible,"close-on-click-modal":!1,title:"请选择要配置的房间"},on:{"update:visible":function(t){e.copyItemToModelVisible=t}}},[o("room-list-select",{ref:"copyItemTo",refInFor:!0,attrs:{"room-list":e.curRoomList,"checked-list":e.defaultCheckObj[a],visible:e.copyItemToModelVisible}}),e._v(" "),o("div",{staticClass:"dialog-footer",staticStyle:{margin:"20px"},attrs:{slot:"footer"},slot:"footer"},[e.curRoomList?o("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.getRoomNumData}},[e._v("确定")]):e._e()],1)],1)],1)})):e._e()],1)],1)]),e._v(" "),e.addHouseType?e._e():o("div",{staticClass:"entry-house-bottom",style:{width:e.toolsWidth}},[e.addHouseType?e._e():o("el-button",{attrs:{loading:e.saveEasteLoading,type:"primary",size:"small"},on:{click:function(t){e.addEstateRoomNext()}}},[e._v("下一步")])],1),e._v(" "),e.addHouseType?o("div",{staticClass:"entry-house-bottom",style:{width:e.toolsWidth}},[[o("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){e.addEstateRoomPrev()}}},[e._v("上一步")]),e._v(" "),o("el-button",{attrs:{loading:e.saveLoading,type:"primary",size:"small"},on:{click:function(t){e.saveRoomDetailData(1)}}},[e._v("保存并继续添加")]),e._v(" "),o("el-button",{attrs:{loading:e.saveLoading,type:"primary",size:"small"},on:{click:function(t){e.saveRoomDetailData(3)}}},[e._v("确定")]),e._v(" "),o("el-button",{attrs:{loading:e.saveLoading,size:"small"},on:{click:function(t){e.saveRoomDetailData(2)}}},[e._v("取消")])]],2):e._e()])},[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"layout_pageHeader"},[t("div",{staticClass:"entry-house-title"},[this._v("\n      新建集中式录入\n    ")])])}],!1,null,"02cb32de",null);P.options.__file="index.vue";t.default=P.exports},TQLM:function(e,t,o){},TYJK:function(e,t,o){"use strict";o.r(t);var a=o("GQeE"),s=o.n(a),i={name:"Roomcheckgroup",components:{},props:{visible:{type:Boolean,default:function(){}},roomList:{type:[Object,Array],default:function(){}},checkedList:{type:Array,default:function(){return[]}},defaultCheckObj:{type:[Object,Array],default:function(){return[]}}},data:function(){return{isIndeterminate:!1,allRoomList:{},checkedFloor:{},checkedObj:{}}},watch:{visible:{immediate:!0,handler:function(e){var t=this;if(Array.isArray(this.roomList))e||(this.roomListForm.checkedRoomList=[]);else{if(e){console.log("checkedList",this.checkedList);var o={},a={},i={};s()(this.roomList).forEach(function(e,s){i[e]=!1,o[e]={},o[e].allRoom=t.roomList[e].map(function(e){return e.roomCode}),o[e].activeRoom=o[e].allRoom.filter(function(e){return!t.checkedList.includes(e)}),o[e].isDisabled=o[e].allRoom.filter(function(t){return!o[e].activeRoom.includes(t)}),a[e]=o[e].isDisabled}),this.$set(this,"allRoomList",o),this.$set(this,"checkedObj",a),this.$set(this,"checkedFloor",i)}s()(this.checkedObj).forEach(function(e,o){t.handleRoomChange(e)})}}}},mounted:function(){},methods:{handleCheckFloorChange:function(e){this.$set(this.checkedObj,e,!!this.checkedFloor[e]&&this.allRoomList[e].allRoom)},handleRoomChange:function(e){var t=this.checkedObj[e].length;this.checkedFloor[e]=t===this.allRoomList[e].allRoom.length},returnCheckedList:function(){var e=this,t=[];return Array.isArray(this.roomList)?t=this.roomListForm.checkedRoomList:s()(this.checkedObj).forEach(function(o,a){e.checkedObj[o]&&(t=t.concat(e.checkedObj[o]))}),console.log("checkedObj",t),{saveRoomList:t,checkedObj:this.checkedObj}}}},l=(o("Owq5"),o("KHd+")),n=Object(l.a)(i,function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",e._l(e.roomList,function(t,a,s){return o("el-row",{key:s,class:{checkRow:t.length}},[o("el-col",{attrs:{span:4}},[t.length>0?o("el-checkbox",{attrs:{label:a},on:{change:function(t){e.handleCheckFloorChange(a)}},model:{value:e.checkedFloor[a],callback:function(t){e.$set(e.checkedFloor,a,t)},expression:"checkedFloor[key]"}}):e._e()],1),e._v(" "),o("el-col",{attrs:{span:19,offset:1}},[o("el-checkbox-group",{staticClass:"room-list-group",model:{value:e.checkedObj[a],callback:function(t){e.$set(e.checkedObj,a,t)},expression:"checkedObj[key]"}},e._l(t,function(t){return t.roomCode?o("el-checkbox",{key:t.roomCode,staticClass:"room-list-checkbox",attrs:{label:t.roomCode},on:{change:function(t){e.handleRoomChange(a)}}},[e._v("\n            "+e._s(t.roomNo)+"\n          ")]):e._e()}))],1)],1)}))},[],!1,null,"618f0ad8",null);n.options.__file="roomListSelect.vue";t.default=n.exports},Yfch:function(e,t,o){"use strict";function a(e){return/^(((13[0-9]{1})|(14[0-9]{1})|(17[0-9]{1})|(15[0-3]{1})|(15[4-9]{1})|(18[0-9]{1})|(199))+\d{8})$/.test(e)}o.d(t,"a",function(){return a})},dFus:function(e,t,o){"use strict";var a=o("nCVW");o.n(a).a},lIRj:function(e,t,o){},nCVW:function(e,t,o){},oYfu:function(e,t,o){"use strict";var a=o("TQLM");o.n(a).a},sNvy:function(e,t,o){"use strict";var a=o("I/sX");o.n(a).a}}]);