(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-5295"],{"/Dk7":function(t,e,i){},"2kZ5":function(t,e,i){"use strict";var a=i("KvgY");i.n(a).a},"9esu":function(t,e,i){"use strict";var a=i("EJiy"),r=i.n(a),n=i("QbLZ"),s=i.n(n),o=i("fnnb"),c={name:"FhtImageCropper",components:{VueCropper:i.n(o).a},props:{cropperList:{type:Array,default:function(){return[]}}},data:function(){return{accept:"image/png, image/jpeg, image/jpg",defaultCropperOptions:{imageName:"",img:"",info:!1,size:1,outputType:"png",canScale:!0,autoCrop:!0,fixed:!0,fixedNumber:[4,3],full:!0},layer_cropper:!1,cropperImgs:[],cropperedImgs:[]}},computed:{itemStyle:function(){return{width:(this.cropperImgs.length>1?400:830)+"px"}},componentStyle:function(){return{height:(this.cropperImgs.length>1?300:600)+"px"}}},watch:{cropperList:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.cropperImgs=e.map(function(e){return s()({},t.defaultCropperOptions,e)}),this.layer_cropper=this.cropperImgs.length>0}},created:function(){var t=this;this.cropperImgs=this.cropperList.map(function(e){return s()({},t.defaultCropperOptions,e)}),this.layer_cropper=this.cropperImgs.length>0},methods:{cropperClose:function(){this.cropperImgs=[]},changeScale:function(t,e){this.$refs["refCropper"+e][0].changeScale(t)},rotateLeft:function(t){this.$refs["refCropper"+t][0].rotateLeft()},rotateRight:function(t){this.$refs["refCropper"+t][0].rotateRight()},getCropData:function(){var t=this,e=0;this.cropperImgs.forEach(function(i,a){t.$refs["refCropper"+a][0].getCropData(function(a){t.cropperedImgs.push({src:a,title:i.imageName}),++e===t.cropperImgs.length&&(t.layer_cropper=!1,t.$emit("emitCropperData",t.cropperedImgs))})})},uploadImg:function(t,e){var i=this;if(!t.target.value)return console.log("取消上传..."),!1;var a=t.target.files[0];if(!this.accept.includes(a.type))return this.$message.error("请上传"+this.accept.replace(/image\//gi,"")+"的图片"),t.target.value=null,!1;var n=new FileReader;n.onerror=function(t){console.log(t+"读取异常....")},n.onload=function(t){var n="object"===r()(t.target.result)?window.URL.createObjectURL(new Blob([t.target.result])):t.target.result,s="";s=a.name?a.name.split(".")[0].length<=30?a.name.split(".")[0]:a.name.split(".")[0].substr(0,30):"",i.cropperImgs[e].img=n,i.$set(i.cropperImgs[e],"img",n),i.$set(i.cropperImgs[e],"imageName",s)},n.readAsDataURL(a),this.layer_cropper=!0,t.target.value=null}}},l=(i("UoXs"),i("KHd+")),p=Object(l.a)(c,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"dialog-cropper"},[i("el-dialog",{attrs:{visible:t.layer_cropper,"append-to-body":"",title:"图片裁剪",width:"920px"},on:{"update:visible":function(e){t.layer_cropper=e},open:function(e){t.cropperedImgs=[]},close:t.cropperClose}},[i("div",{staticClass:"cropper-wrapper"},t._l(t.cropperImgs,function(e,a){return i("div",{key:a,staticClass:"cropper-item",style:t.itemStyle},[i("div",{staticClass:"cropper-component",style:t.componentStyle},[i("vueCropper",{ref:"refCropper"+a,refInFor:!0,attrs:{img:e.img,"output-size":e.size,"output-type":e.outputType,info:e.info,"can-scale":e.canScale,"auto-crop":e.autoCrop,"auto-crop-width":e.autoCropWidth,"auto-crop-height":e.autoCropHeight,full:e.full,fixed:e.fixed,"fixed-number":e.fixedNumber}})],1),t._v(" "),i("div",{staticClass:"cropper-btn--group clearfix"},[i("el-input",{staticClass:"cropper-input--imageName",attrs:{maxlength:30,placeholder:"请输入图片名称",size:"small"},model:{value:e.imageName,callback:function(i){t.$set(e,"imageName",i)},expression:"item.imageName"}}),t._v(" "),i("el-button-group",{staticClass:"btn-group right"},[i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"替换图片",placement:"top-start"}},[i("label",{staticClass:"el-button el-button--primary el-button--small",attrs:{for:"changeImage"+a}},[i("i",{staticClass:"el-icon-upload"})])]),t._v(" "),i("input",{attrs:{id:"changeImage"+a,accept:t.accept,type:"file",hidden:""},on:{change:function(e){t.uploadImg(e,a)}}}),t._v(" "),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"放大图片",placement:"top-start"}},[i("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-zoom-in"},on:{click:function(e){t.changeScale(1,a)}}})],1),t._v(" "),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"缩小图片",placement:"top-start"}},[i("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-zoom-out"},on:{click:function(e){t.changeScale(-1,a)}}})],1),t._v(" "),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"逆时针旋转90°",placement:"top-start"}},[i("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-caret-left"},on:{click:function(e){t.rotateLeft(a)}}})],1),t._v(" "),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"顺时针旋转90°",placement:"top-start"}},[i("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-caret-right"},on:{click:function(e){t.rotateRight(a)}}})],1)],1)],1)])})),t._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"small"},on:{click:function(e){t.layer_cropper=!1}}},[t._v("取 消")]),t._v(" "),i("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.getCropData}},[t._v("确 定")])],1)])],1)},[],!1,null,"1216884e",null);p.options.__file="Cropper.vue";e.a=p.exports},KX4T:function(t,e,i){},KspW:function(t,e,i){"use strict";i.r(e);var a=i("m1cH"),r=i.n(a),n=i("14Xm"),s=i.n(n),o=i("EJiy"),c=i.n(o),l=i("4d7F"),p=i.n(l),u=i("D3Ub"),m=i.n(u),g=i("vXZP"),f=i("9esu"),d={name:"UploadImg",components:{Preview:g.a,ImageCropper:f.a},data:function(){return{estateRoomDetail:{pictures:[]},uploadPicsModelVisible:!1,curPicListIndex:-1,currentPicList:[],cropperList:[],accept:"image/png, image/jpeg, image/jpg"}},methods:{uploadImg:function(t){var e=this;return m()(s.a.mark(function i(){var a,r,n,o,l;return s.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(t.target.value){i.next=2;break}return i.abrupt("return",!1);case 2:if(a=[],r=function(t){return new p.a(function(e){var i=new FileReader;i.onerror=function(t){console.log("读取异常....")},i.onload=function(i){var a="object"===c()(i.target.result)?window.URL.createObjectURL(new Blob([i.target.result])):i.target.result,r="";r=t.name?t.name.split(".")[0].length<=30?t.name.split(".")[0]:t.name.split(".")[0].substr(0,30):"",e({img:a,imageName:r,type:1})},i.readAsDataURL(t)})},n=t.target.files,!((o=e.currentPicList).length+n.length>15)){i.next=10;break}return e.$message.error("您已上传"+o.length+"张图片，最多还能上传"+(15-o.length)+"张图片"),t.target.value=null,i.abrupt("return",!1);case 10:l=0;case 11:if(!(l<n.length)){i.next=24;break}if(e.accept.includes(n[l].type)){i.next=16;break}return e.$message.error("请上传"+e.accept.replace(/image\//gi,"")+"的图片"),t.target.value=null,i.abrupt("return",!1);case 16:return i.t0=a,i.next=19,r(n[l]);case 19:i.t1=i.sent,i.t0.push.call(i.t0,i.t1);case 21:l++,i.next=11;break;case 24:console.log("e.target.files",t.target.files),e.cropperList=a.map(function(t,e){return{img:t.img,imageName:t.imageName,type:t.type}}),t.target.value=null;case 27:case"end":return i.stop()}},i,e)}))()},openPicModel:function(t){this.curPicListIndex=t,this.currentPicList=-1===t?this.estateRoomDetail.pictures:this.estateRoomDetail.hostingRooms[t].pictures,this.uploadPicsModelVisible=!0},emitDelete:function(t){this.currentPicList=t||[]},emitCropperData:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];console.log("list1",t),t.forEach(function(t,e){t.type=1,t.imageName=t.title,void 0===t.isBase64&&(t.isBase64=1)}),console.log("list2",t),this.currentPicList=[].concat(r()(this.currentPicList),r()(t)),console.log("上传图片组件中的",this.currentPicList)},uploadModelClose:function(){-1===this.curPicListIndex?this.estateRoomDetail.pictures=this.currentPicList:this.estateRoomDetail.hostingRooms[this.curPicListIndex].pictures=this.currentPicList,console.log("cc",this.estateRoomDetail.pictures),this.currentPicList=[]}}},h=(i("2kZ5"),i("KHd+")),v=Object(h.a)(d,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[t.estateRoomDetail.pictures.length?i("el-badge",{attrs:{value:t.estateRoomDetail.pictures.length}},[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){t.openPicModel()}}},[t._v("上传照片")])],1):i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){t.openPicModel()}}},[t._v("上传照片")]),t._v(" "),i("el-dialog",{attrs:{visible:t.uploadPicsModelVisible,"append-to-body":"",title:"上传公寓照片","custom-class":"upload-pics-model",width:"600px"},on:{"update:visible":function(e){t.uploadPicsModelVisible=e},close:t.uploadModelClose}},[i("div",{staticClass:"previewItems"},[i("Preview",{attrs:{"pic-list":t.currentPicList,"delete-icon":!0,disabled:!1},on:{emitDelete:t.emitDelete}}),t._v(" "),i("label",{staticClass:"el-upload el-upload--picture-card uploadImage",attrs:{for:"uploadImages"}},[i("i",{staticClass:"el-icon-plus"}),t._v(" "),i("input",{attrs:{id:"uploadImages",accept:t.accept,type:"file",multiple:""},on:{change:function(e){t.uploadImg(e)}}})])],1),t._v(" "),i("p",{staticClass:"upload-pics-info"},[t._v("温馨提示： ")]),t._v(" "),i("p",{staticClass:"upload-pics-info"},[t._v("1.请勿上传虚假、模糊、与房源信息无关、含有其他公司水印的照片； ")]),t._v(" "),i("p",{staticClass:"upload-pics-info"},[t._v("2.房间照片最佳组合：卧室2~6张、公共区域1~4张、厨房1~3张、卫生间1-4张； ")]),t._v(" "),i("p",{staticClass:"upload-pics-info"},[t._v("3.目前最多支持15张，支持JPG/JPEG/PNG，可以拖动图片进行排序，支持批量上传。")]),t._v(" "),i("ImageCropper",{attrs:{"cropper-list":t.cropperList},on:{emitCropperData:t.emitCropperData}}),t._v(" "),i("span",{attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){t.uploadPicsModelVisible=!1}}},[t._v("关 闭")])],1)],1)],1)},[],!1,null,null,null);v.options.__file="uploadImg.vue";e.default=v.exports},KvgY:function(t,e,i){},UoXs:function(t,e,i){"use strict";var a=i("/Dk7");i.n(a).a},ec3i:function(t,e,i){"use strict";var a=i("jUJg");i.n(a).a},jUJg:function(t,e,i){},k6VY:function(t,e,i){"use strict";var a=i("KX4T");i.n(a).a},vXZP:function(t,e,i){"use strict";var a=i("14Xm"),r=i.n(a),n=i("4d7F"),s=i.n(n),o=i("D3Ub"),c=i.n(o),l=i("FRYs"),p=i.n(l);document.body.ondrop=function(t){t.preventDefault(),t.stopPropagation()};var u={name:"FhtPreview",components:{draggable:p.a},props:{picList:{type:Array,default:function(){return[]}},deleteIcon:{type:Boolean,default:!1},itemSize:{type:Object,default:function(){return{}}},disabled:{type:Boolean,default:!0}},data:function(){return{list:[],isDragging:!1,delayedDragging:!1}},computed:{itemStyle:function(){return{width:this.itemSize.width+"px",height:this.itemSize.height+"px"}},dragOptions:function(){return{animation:150,group:"description",ghostClass:"ghost",disabled:this.disabled}}},watch:{picList:{immediate:!0,handler:function(t){this.list=(t||[]).slice(),this.list.map(function(t,e){t.sortNum=t.sortNum?t.sortNum:Math.random().toFixed(5),t.type=t.type||1,t.title=t.picTag||""})}},isDragging:function(t){var e=this;t?this.delayedDragging=!0:this.$nextTick(function(){e.delayedDragging=!1})}},mounted:function(){},methods:{handlePreview:function(t){var e=this;return c()(r.a.mark(function i(){var a,n,o;return r.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(1!==e.list.length||!e.list[0].isnoPic){i.next=3;break}return e.$message.warning("友情提示：暂无图片"),i.abrupt("return",!1);case 3:a=function(t){return new s.a(function(e){var i=new Image;i.src=t.src,i.onload=function(a){t.w=i.width||800,t.h=i.height||600,e(t)}})},n=[],o=0;case 6:if(!(o<e.list.length)){i.next=15;break}return i.t0=n,i.next=10,a(e.list[o]);case 10:i.t1=i.sent,i.t0.push.call(i.t0,i.t1);case 12:o++,i.next=6;break;case 15:e.$preview.open(t,n);case 16:case"end":return i.stop()}},i,e)}))()},handleDelete:function(t,e){var i=this;this.$confirm("是否删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){i.list.splice(t,1),i.handleEmit()}).catch(function(){})},handleEmit:function(){this.$emit("emitDelete",this.list)},startDrag:function(){this.isDragging=!0},endDrag:function(t){this.isDragging=!1,this.handleEmit()}}},m=(i("k6VY"),i("ec3i"),i("KHd+")),g=Object(m.a)(u,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("draggable",{staticClass:"list-group",attrs:{options:t.dragOptions,element:"ul"},on:{start:t.startDrag,end:t.endDrag},model:{value:t.list,callback:function(e){t.list=e},expression:"list"}},[i("transition-group",{staticClass:"previewItems",attrs:{name:"flip-list",type:"transition"}},t._l(t.list,function(e,a){return i("li",{key:e.sortNum,staticClass:"preview-item clearfix",style:t.itemStyle},[i("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.src,expression:"item.src"}],staticClass:"preview-img img-center"}),t._v(" "),e.picTag?i("span",{staticClass:"preview-tags"},[t._v(t._s(e.picTag))]):t._e(),t._v(" "),i("span",{staticClass:"preview-item-actions"},[i("span",{staticClass:"preview-item__item-preview",on:{click:function(e){t.handlePreview(a)}}},[i("i",{staticClass:"el-icon-zoom-in"})]),t._v(" "),t.deleteIcon?i("span",{staticClass:"preview-item__item-delete",on:{click:function(i){t.handleDelete(a,e)}}},[i("i",{staticClass:"el-icon-delete"})]):t._e()])])}))],1)},[],!1,null,"0e5cb646",null);g.options.__file="Preview.vue";e.a=g.exports}}]);